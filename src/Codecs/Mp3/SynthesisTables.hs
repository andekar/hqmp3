
module Codecs.Mp3.SynthesisTables ( synth_window
                                  , updateVals
--                                   , listA
                                  , outList
                                  , outList2
                                  ) where

import Data.Array.Unboxed as U
import Data.Array.ST as ST
import Control.Monad
import Control.Monad.ST
import Control.Arrow

-- Lets just hope that this turns into an array at compile time
-- These values have double precision!!!!!
synth_window :: U.UArray Int Double
synth_window = U.listArray (0,511)
      [ 0.000000000, -0.000015259, -0.000015259, -0.000015259, -0.000015259,
       -0.000015259, -0.000015259, -0.000030518, -0.000030518, -0.000030518,
       -0.000030518, -0.000045776, -0.000045776, -0.000061035, -0.000061035,
       -0.000076294, -0.000076294, -0.000091553, -0.000106812, -0.000106812,
       -0.000122070, -0.000137329, -0.000152588, -0.000167847, -0.000198364,
       -0.000213623, -0.000244141, -0.000259399, -0.000289917, -0.000320435,
       -0.000366211, -0.000396729, -0.000442505, -0.000473022, -0.000534058,
       -0.000579834, -0.000625610, -0.000686646, -0.000747681, -0.000808716,
       -0.000885010, -0.000961304, -0.001037598, -0.001113892, -0.001205444,
       -0.001296997, -0.001388550, -0.001480103, -0.001586914, -0.001693726,
       -0.001785278, -0.001907349, -0.002014160, -0.002120972, -0.002243042,
       -0.002349854, -0.002456665, -0.002578735, -0.002685547, -0.002792358,
       -0.002899170, -0.002990723, -0.003082275, -0.003173828,  0.003250122,
        0.003326416,  0.003387451,  0.003433228,  0.003463745,  0.003479004,
        0.003479004,  0.003463745,  0.003417969,  0.003372192,  0.003280640,
        0.003173828,  0.003051758,  0.002883911,  0.002700806,  0.002487183,
        0.002227783,  0.001937866,  0.001617432,  0.001266479,  0.000869751,
        0.000442505, -0.000030518, -0.000549316, -0.001098633, -0.001693726,
       -0.002334595, -0.003005981, -0.003723145, -0.004486084, -0.005294800,
       -0.006118774, -0.007003784, -0.007919312, -0.008865356, -0.009841919,
       -0.010848999, -0.011886597, -0.012939453, -0.014022827, -0.015121460,
       -0.016235352, -0.017349243, -0.018463135, -0.019577026, -0.020690918,
       -0.021789551, -0.022857666, -0.023910522, -0.024932861, -0.025909424,
       -0.026840210, -0.027725220, -0.028533936, -0.029281616, -0.029937744,
       -0.030532837, -0.031005859, -0.031387329, -0.031661987, -0.031814575,
       -0.031845093, -0.031738281, -0.031478882,  0.031082153,  0.030517578,
        0.029785156,  0.028884888,  0.027801514,  0.026535034,  0.025085449,
        0.023422241,  0.021575928,  0.019531250,  0.017257690,  0.014801025,
        0.012115479,  0.009231567,  0.006134033,  0.002822876, -0.000686646,
       -0.004394531, -0.008316040, -0.012420654, -0.016708374, -0.021179199,
       -0.025817871, -0.030609131, -0.035552979, -0.040634155, -0.045837402,
       -0.051132202, -0.056533813, -0.061996460, -0.067520142, -0.073059082,
       -0.078628540, -0.084182739, -0.089706421, -0.095169067, -0.100540161,
       -0.105819702, -0.110946655, -0.115921021, -0.120697021, -0.125259399,
       -0.129562378, -0.133590698, -0.137298584, -0.140670776, -0.143676758,
       -0.146255493, -0.148422241, -0.150115967, -0.151306152, -0.151962280,
       -0.152069092, -0.151596069, -0.150497437, -0.148773193, -0.146362305,
       -0.143264771, -0.139450073, -0.134887695, -0.129577637, -0.123474121,
       -0.116577148, -0.108856201,  0.100311279,  0.090927124,  0.080688477,
        0.069595337,  0.057617188,  0.044784546,  0.031082153,  0.016510010,
        0.001068115, -0.015228271, -0.032379150, -0.050354004, -0.069168091,
       -0.088775635, -0.109161377, -0.130310059, -0.152206421, -0.174789429,
       -0.198059082, -0.221984863, -0.246505737, -0.271591187, -0.297210693,
       -0.323318481, -0.349868774, -0.376800537, -0.404083252, -0.431655884,
       -0.459472656, -0.487472534, -0.515609741, -0.543823242, -0.572036743,
       -0.600219727, -0.628295898, -0.656219482, -0.683914185, -0.711318970,
       -0.738372803, -0.765029907, -0.791213989, -0.816864014, -0.841949463,
       -0.866363525, -0.890090942, -0.913055420, -0.935195923, -0.956481934,
       -0.976852417, -0.996246338, -1.014617920, -1.031936646, -1.048156738,
       -1.063217163, -1.077117920, -1.089782715, -1.101211548, -1.111373901,
       -1.120223999, -1.127746582, -1.133926392, -1.138763428, -1.142211914,
       -1.144287109,  1.144989014,  1.144287109,  1.142211914,  1.138763428,
        1.133926392,  1.127746582,  1.120223999,  1.111373901,  1.101211548,
        1.089782715,  1.077117920,  1.063217163,  1.048156738,  1.031936646,
        1.014617920,  0.996246338,  0.976852417,  0.956481934,  0.935195923,
        0.913055420,  0.890090942,  0.866363525,  0.841949463,  0.816864014,
        0.791213989,  0.765029907,  0.738372803,  0.711318970,  0.683914185,
        0.656219482,  0.628295898,  0.600219727,  0.572036743,  0.543823242,
        0.515609741,  0.487472534,  0.459472656,  0.431655884,  0.404083252,
        0.376800537,  0.349868774,  0.323318481,  0.297210693,  0.271591187,
        0.246505737,  0.221984863,  0.198059082,  0.174789429,  0.152206421,
        0.130310059,  0.109161377,  0.088775635,  0.069168091,  0.050354004,
        0.032379150,  0.015228271, -0.001068115, -0.016510010, -0.031082153,
       -0.044784546, -0.057617188, -0.069595337, -0.080688477, -0.090927124,
        0.100311279,  0.108856201,  0.116577148,  0.123474121,  0.129577637,
        0.134887695,  0.139450073,  0.143264771,  0.146362305,  0.148773193,
        0.150497437,  0.151596069,  0.152069092,  0.151962280,  0.151306152,
        0.150115967,  0.148422241,  0.146255493,  0.143676758,  0.140670776,
        0.137298584,  0.133590698,  0.129562378,  0.125259399,  0.120697021,
        0.115921021,  0.110946655,  0.105819702,  0.100540161,  0.095169067,
        0.089706421,  0.084182739,  0.078628540,  0.073059082,  0.067520142,
        0.061996460,  0.056533813,  0.051132202,  0.045837402,  0.040634155,
        0.035552979,  0.030609131,  0.025817871,  0.021179199,  0.016708374,
        0.012420654,  0.008316040,  0.004394531,  0.000686646, -0.002822876,
       -0.006134033, -0.009231567, -0.012115479, -0.014801025, -0.017257690,
       -0.019531250, -0.021575928, -0.023422241, -0.025085449, -0.026535034,
       -0.027801514, -0.028884888, -0.029785156, -0.030517578,  0.031082153,
        0.031478882,  0.031738281,  0.031845093,  0.031814575,  0.031661987,
        0.031387329,  0.031005859,  0.030532837,  0.029937744,  0.029281616,
        0.028533936,  0.027725220,  0.026840210,  0.025909424,  0.024932861,
        0.023910522,  0.022857666,  0.021789551,  0.020690918,  0.019577026,
        0.018463135,  0.017349243,  0.016235352,  0.015121460,  0.014022827,
        0.012939453,  0.011886597,  0.010848999,  0.009841919,  0.008865356,
        0.007919312,  0.007003784,  0.006118774,  0.005294800,  0.004486084,
        0.003723145,  0.003005981,  0.002334595,  0.001693726,  0.001098633,
        0.000549316,  0.000030518, -0.000442505, -0.000869751, -0.001266479,
       -0.001617432, -0.001937866, -0.002227783, -0.002487183, -0.002700806,
       -0.002883911, -0.003051758, -0.003173828, -0.003280640, -0.003372192,
       -0.003417969, -0.003463745, -0.003479004, -0.003479004, -0.003463745,
       -0.003433228, -0.003387451, -0.003326416,  0.003250122,  0.003173828,
        0.003082275,  0.002990723,  0.002899170,  0.002792358,  0.002685547,
        0.002578735,  0.002456665,  0.002349854,  0.002243042,  0.002120972,
        0.002014160,  0.001907349,  0.001785278,  0.001693726,  0.001586914,
        0.001480103,  0.001388550,  0.001296997,  0.001205444,  0.001113892,
        0.001037598,  0.000961304,  0.000885010,  0.000808716,  0.000747681,
        0.000686646,  0.000625610,  0.000579834,  0.000534058,  0.000473022,
        0.000442505,  0.000396729,  0.000366211,  0.000320435,  0.000289917,
        0.000259399,  0.000244141,  0.000213623,  0.000198364,  0.000167847,
        0.000152588,  0.000137329,  0.000122070,  0.000106812,  0.000106812,
        0.000091553,  0.000076294,  0.000076294,  0.000061035,  0.000061035,
        0.000045776,  0.000045776,  0.000030518,  0.000030518,  0.000030518,
        0.000030518,  0.000015259,  0.000015259,  0.000015259,  0.000015259,
        0.000015259,  0.000015259]

-- should be replaced by zip (map (* 18) [0..31]) [0..31] but needs to be evaluated at compile time
updateVals :: [(Int,Int)]
updateVals = [(0,0),(18,1),(36,2),(54,3),(72,4),(90,5),(108,6),(126,7),(144,8)
            ,(162,9),(180,10),(198,11),(216,12),(234,13),(252,14),(270,15)
            ,(288,16),(306,17),(324,18),(342,19),(360,20),(378,21),(396,22)
            ,(414,23),(432,24),(450,25),(468,26),(486,27),(504,28),(522,29)
            ,(540,30),(558,31)]

-- should be evaluated at compile time
fun = zipWith (\x y -> map (\y' -> ( x * 128 + y' {- i' -}
                                 , x * 128 + y' + 96 {- i' + 96-}
                                 , x * 64 + y' {- i'' -}
                                 , x * 64 + y' + 32 {-i'' + 32-}
                                   ))
               y) ([0..7]) (replicate 8 [0..31])


funOutList2 = zipWith (\x y -> map (\y' -> (x + y' * 32
                                   ))
                       y) [0..31] (replicate 32 [0..15])

outList2:: [([Int],Int)]
outList2 = [([0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,480],0),([1,33,65,97,129,161,193,225,257,289,321,353,385,417,449,481],1),([2,34,66,98,130,162,194,226,258,290,322,354,386,418,450,482],2),([3,35,67,99,131,163,195,227,259,291,323,355,387,419,451,483],3),([4,36,68,100,132,164,196,228,260,292,324,356,388,420,452,484],4),([5,37,69,101,133,165,197,229,261,293,325,357,389,421,453,485],5),([6,38,70,102,134,166,198,230,262,294,326,358,390,422,454,486],6),([7,39,71,103,135,167,199,231,263,295,327,359,391,423,455,487],7),([8,40,72,104,136,168,200,232,264,296,328,360,392,424,456,488],8),([9,41,73,105,137,169,201,233,265,297,329,361,393,425,457,489],9),([10,42,74,106,138,170,202,234,266,298,330,362,394,426,458,490],10),([11,43,75,107,139,171,203,235,267,299,331,363,395,427,459,491],11),([12,44,76,108,140,172,204,236,268,300,332,364,396,428,460,492],12),([13,45,77,109,141,173,205,237,269,301,333,365,397,429,461,493],13),([14,46,78,110,142,174,206,238,270,302,334,366,398,430,462,494],14),([15,47,79,111,143,175,207,239,271,303,335,367,399,431,463,495],15),([16,48,80,112,144,176,208,240,272,304,336,368,400,432,464,496],16),([17,49,81,113,145,177,209,241,273,305,337,369,401,433,465,497],17),([18,50,82,114,146,178,210,242,274,306,338,370,402,434,466,498],18),([19,51,83,115,147,179,211,243,275,307,339,371,403,435,467,499],19),([20,52,84,116,148,180,212,244,276,308,340,372,404,436,468,500],20),([21,53,85,117,149,181,213,245,277,309,341,373,405,437,469,501],21),([22,54,86,118,150,182,214,246,278,310,342,374,406,438,470,502],22),([23,55,87,119,151,183,215,247,279,311,343,375,407,439,471,503],23),([24,56,88,120,152,184,216,248,280,312,344,376,408,440,472,504],24),([25,57,89,121,153,185,217,249,281,313,345,377,409,441,473,505],25),([26,58,90,122,154,186,218,250,282,314,346,378,410,442,474,506],26),([27,59,91,123,155,187,219,251,283,315,347,379,411,443,475,507],27),([28,60,92,124,156,188,220,252,284,316,348,380,412,444,476,508],28),([29,61,93,125,157,189,221,253,285,317,349,381,413,445,477,509],29),([30,62,94,126,158,190,222,254,286,318,350,382,414,446,478,510],30),([31,63,95,127,159,191,223,255,287,319,351,383,415,447,479,511],31)]

outList :: [[(Int,Int,Int,Int)]]
outList = [[(0,96,0,32),(1,97,1,33),(2,98,2,34),(3,99,3,35),(4,100,4,36),(5,101,5,37),(6,102,6,38),(7,103,7,39),(8,104,8,40),(9,105,9,41),(10,106,10,42),(11,107,11,43),(12,108,12,44),(13,109,13,45),(14,110,14,46),(15,111,15,47),(16,112,16,48),(17,113,17,49),(18,114,18,50),(19,115,19,51),(20,116,20,52),(21,117,21,53),(22,118,22,54),(23,119,23,55),(24,120,24,56),(25,121,25,57),(26,122,26,58),(27,123,27,59),(28,124,28,60),(29,125,29,61),(30,126,30,62),(31,127,31,63)],[(128,224,64,96),(129,225,65,97),(130,226,66,98),(131,227,67,99),(132,228,68,100),(133,229,69,101),(134,230,70,102),(135,231,71,103),(136,232,72,104),(137,233,73,105),(138,234,74,106),(139,235,75,107),(140,236,76,108),(141,237,77,109),(142,238,78,110),(143,239,79,111),(144,240,80,112),(145,241,81,113),(146,242,82,114),(147,243,83,115),(148,244,84,116),(149,245,85,117),(150,246,86,118),(151,247,87,119),(152,248,88,120),(153,249,89,121),(154,250,90,122),(155,251,91,123),(156,252,92,124),(157,253,93,125),(158,254,94,126),(159,255,95,127)],[(256,352,128,160),(257,353,129,161),(258,354,130,162),(259,355,131,163),(260,356,132,164),(261,357,133,165),(262,358,134,166),(263,359,135,167),(264,360,136,168),(265,361,137,169),(266,362,138,170),(267,363,139,171),(268,364,140,172),(269,365,141,173),(270,366,142,174),(271,367,143,175),(272,368,144,176),(273,369,145,177),(274,370,146,178),(275,371,147,179),(276,372,148,180),(277,373,149,181),(278,374,150,182),(279,375,151,183),(280,376,152,184),(281,377,153,185),(282,378,154,186),(283,379,155,187),(284,380,156,188),(285,381,157,189),(286,382,158,190),(287,383,159,191)],[(384,480,192,224),(385,481,193,225),(386,482,194,226),(387,483,195,227),(388,484,196,228),(389,485,197,229),(390,486,198,230),(391,487,199,231),(392,488,200,232),(393,489,201,233),(394,490,202,234),(395,491,203,235),(396,492,204,236),(397,493,205,237),(398,494,206,238),(399,495,207,239),(400,496,208,240),(401,497,209,241),(402,498,210,242),(403,499,211,243),(404,500,212,244),(405,501,213,245),(406,502,214,246),(407,503,215,247),(408,504,216,248),(409,505,217,249),(410,506,218,250),(411,507,219,251),(412,508,220,252),(413,509,221,253),(414,510,222,254),(415,511,223,255)],[(512,608,256,288),(513,609,257,289),(514,610,258,290),(515,611,259,291),(516,612,260,292),(517,613,261,293),(518,614,262,294),(519,615,263,295),(520,616,264,296),(521,617,265,297),(522,618,266,298),(523,619,267,299),(524,620,268,300),(525,621,269,301),(526,622,270,302),(527,623,271,303),(528,624,272,304),(529,625,273,305),(530,626,274,306),(531,627,275,307),(532,628,276,308),(533,629,277,309),(534,630,278,310),(535,631,279,311),(536,632,280,312),(537,633,281,313),(538,634,282,314),(539,635,283,315),(540,636,284,316),(541,637,285,317),(542,638,286,318),(543,639,287,319)],[(640,736,320,352),(641,737,321,353),(642,738,322,354),(643,739,323,355),(644,740,324,356),(645,741,325,357),(646,742,326,358),(647,743,327,359),(648,744,328,360),(649,745,329,361),(650,746,330,362),(651,747,331,363),(652,748,332,364),(653,749,333,365),(654,750,334,366),(655,751,335,367),(656,752,336,368),(657,753,337,369),(658,754,338,370),(659,755,339,371),(660,756,340,372),(661,757,341,373),(662,758,342,374),(663,759,343,375),(664,760,344,376),(665,761,345,377),(666,762,346,378),(667,763,347,379),(668,764,348,380),(669,765,349,381),(670,766,350,382),(671,767,351,383)],[(768,864,384,416),(769,865,385,417),(770,866,386,418),(771,867,387,419),(772,868,388,420),(773,869,389,421),(774,870,390,422),(775,871,391,423),(776,872,392,424),(777,873,393,425),(778,874,394,426),(779,875,395,427),(780,876,396,428),(781,877,397,429),(782,878,398,430),(783,879,399,431),(784,880,400,432),(785,881,401,433),(786,882,402,434),(787,883,403,435),(788,884,404,436),(789,885,405,437),(790,886,406,438),(791,887,407,439),(792,888,408,440),(793,889,409,441),(794,890,410,442),(795,891,411,443),(796,892,412,444),(797,893,413,445),(798,894,414,446),(799,895,415,447)],[(896,992,448,480),(897,993,449,481),(898,994,450,482),(899,995,451,483),(900,996,452,484),(901,997,453,485),(902,998,454,486),(903,999,455,487),(904,1000,456,488),(905,1001,457,489),(906,1002,458,490),(907,1003,459,491),(908,1004,460,492),(909,1005,461,493),(910,1006,462,494),(911,1007,463,495),(912,1008,464,496),(913,1009,465,497),(914,1010,466,498),(915,1011,467,499),(916,1012,468,500),(917,1013,469,501),(918,1014,470,502),(919,1015,471,503),(920,1016,472,504),(921,1017,473,505),(922,1018,474,506),(923,1019,475,507),(924,1020,476,508),(925,1021,477,509),(926,1022,478,510),(927,1023,479,511)]]